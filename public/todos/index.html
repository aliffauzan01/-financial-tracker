<!DOCTYPE html>
<html>
<body>
<h1>Todos</h1>

<input id="todoText" placeholder="tambah todo">
<button onclick="addTodo()">Tambah</button>

<ul id="list"></ul>

<button onclick="location.href='/dashboard'">Kembali</button>

<script>
async function loadTodos() {
  const res = await fetch("/api/todos")
  const data = await res.json()

  if (!data.success) {
    location.href = "/login"
    return
  }

  list.innerHTML = ""
  data.todos.forEach(t => {
    const li = document.createElement("li")
    li.innerText = t.text
    list.appendChild(li)
  })
}

async function addTodo() {
  await fetch("/api/todos", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ text: todoText.value })
  })

  todoText.value = ""
  loadTodos()
}

loadTodos()
</script>
</body>
</html>
